{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/hinat/projects/weekly-report-app/src/app/reports/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Link from \"next/link\";\r\n\r\ntype TaskStatus = \"not_decided\" | \"todo\" | \"doing\" | \"done\";\r\n\r\ntype Task = {\r\n  id: string;\r\n  title: string;\r\n  status: TaskStatus;\r\n};\r\n\r\nconst STATUS_LABEL: Record<TaskStatus, string> = {\r\n  not_decided: \"未決定\",\r\n  todo: \"未着手\",\r\n  doing: \"進行中\",\r\n  done: \"完了\",\r\n};\r\n\r\nconst STATUS_ORDER: TaskStatus[] = [\"not_decided\", \"todo\", \"doing\", \"done\"];\r\n\r\nexport default function ReportDetailPage({\r\n  params,\r\n}: {\r\n  params: { id: string };\r\n}) {\r\n  // 週報IDごとに別々のキー\r\n  const storageKey = `weekly-report-tasks-${String(params.id)}`;\r\n\r\n  const [newTitle, setNewTitle] = useState(\"\");\r\n  const [tasks, setTasks] = useState<Task[]>([]);\r\n  const [loaded, setLoaded] = useState(false);\r\n  const [savedMessage, setSavedMessage] = useState(\"\");\r\n\r\n  // ★ 初回＋「IDが変わったとき」に localStorage から読み込む\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    const raw = window.localStorage.getItem(storageKey);\r\n\r\n    if (!raw) {\r\n      // このID用のデータがまだ無いときは、前のIDのタスクを引き継がずリセットする\r\n      setTasks([]);\r\n      setLoaded(true);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const parsed = JSON.parse(raw) as Task[];\r\n      if (Array.isArray(parsed)) {\r\n        setTasks(parsed);\r\n      } else {\r\n        setTasks([]);\r\n      }\r\n    } catch (e) {\r\n      console.error(\"failed to parse tasks from localStorage\", e);\r\n      setTasks([]);\r\n    }\r\n\r\n    setLoaded(true);\r\n  }, [storageKey]);\r\n\r\n  // tasks が変わったら自動保存\r\n  useEffect(() => {\r\n    if (!loaded) return;\r\n    if (typeof window === \"undefined\") return;\r\n\r\n    window.localStorage.setItem(storageKey, JSON.stringify(tasks));\r\n\r\n    if (tasks.length === 0) {\r\n      setSavedMessage(\"\");\r\n      return;\r\n    }\r\n    setSavedMessage(\"自動保存しました\");\r\n    const timer = setTimeout(() => setSavedMessage(\"\"), 1500);\r\n    return () => clearTimeout(timer);\r\n  }, [tasks, loaded, storageKey]);\r\n\r\n  const handleAddTask = () => {\r\n    const trimmed = newTitle.trim();\r\n    if (!trimmed) return;\r\n\r\n    const newTask: Task = {\r\n      id: crypto.randomUUID(),\r\n      title: trimmed,\r\n      status: \"todo\", // 初期ステータス：未着手\r\n    };\r\n\r\n    setTasks((prev) => [newTask, ...prev]);\r\n    setNewTitle(\"\");\r\n  };\r\n\r\n  const handleKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === \"Enter\") {\r\n      e.preventDefault();\r\n      handleAddTask();\r\n    }\r\n  };\r\n\r\n  const handleChangeStatus = (id: string, status: TaskStatus) => {\r\n    setTasks((prev) =>\r\n      prev.map((task) =>\r\n        task.id === id\r\n          ? {\r\n              ...task,\r\n              status,\r\n            }\r\n          : task\r\n      )\r\n    );\r\n  };\r\n\r\n  const handleDelete = (id: string) => {\r\n    setTasks((prev) => prev.filter((task) => task.id !== id));\r\n  };\r\n\r\n  const countsByStatus: Record<TaskStatus, number> = {\r\n    not_decided: tasks.filter((t) => t.status === \"not_decided\").length,\r\n    todo: tasks.filter((t) => t.status === \"todo\").length,\r\n    doing: tasks.filter((t) => t.status === \"doing\").length,\r\n    done: tasks.filter((t) => t.status === \"done\").length,\r\n  };\r\n\r\n  return (\r\n    <main className=\"max-w-5xl mx-auto py-6 px-3 md:px-4 space-y-6\">\r\n      {/* ヘッダー */}\r\n      <header className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\r\n        <div className=\"space-y-1.5\">\r\n          <Link\r\n            href=\"/reports\"\r\n            className=\"inline-flex items-center text-[11px] md:text-xs text-slate-600 hover:text-slate-900\"\r\n          >\r\n            ← 週報一覧に戻る\r\n          </Link>\r\n          <h1 className=\"text-xl md:text-2xl font-bold\">\r\n            週報ID: {params.id} のタスク管理\r\n          </h1>\r\n          <p className=\"text-xs md:text-sm text-slate-600 max-w-2xl\">\r\n            今週やることを箇条書きで洗い出して、ステータスを切り替えながら進捗を管理します。\r\n            タスクは「週報IDごとに」ブラウザへ自動保存されます。\r\n          </p>\r\n          <p className=\"text-[10px] text-slate-400\">\r\n            storageKey: <code>{storageKey}</code>\r\n          </p>\r\n          {!loaded && (\r\n            <p className=\"text-[11px] text-slate-500\">読み込み中...</p>\r\n          )}\r\n        </div>\r\n\r\n        <div className=\"flex flex-col items-end gap-1.5\">\r\n          <div className=\"flex flex-wrap gap-1.5 text-[11px] md:text-xs\">\r\n            <span className=\"inline-flex items-center rounded-full bg-slate-100 px-2.5 py-1\">\r\n              合計:{\" \"}\r\n              <span className=\"ml-1 font-semibold text-slate-800\">\r\n                {tasks.length}\r\n              </span>\r\n            </span>\r\n            <span className=\"inline-flex items-center rounded-full bg-emerald-50 px-2.5 py-1\">\r\n              完了:{\" \"}\r\n              <span className=\"ml-1 font-semibold text-emerald-700\">\r\n                {countsByStatus.done}\r\n              </span>\r\n            </span>\r\n            <span className=\"inline-flex items-center rounded-full bg-blue-50 px-2.5 py-1\">\r\n              進行中:{\" \"}\r\n              <span className=\"ml-1 font-semibold text-blue-700\">\r\n                {countsByStatus.doing}\r\n              </span>\r\n            </span>\r\n            <span className=\"inline-flex items-center rounded-full bg-amber-50 px-2.5 py-1\">\r\n              未着手:{\" \"}\r\n              <span className=\"ml-1 font-semibold text-amber-700\">\r\n                {countsByStatus.todo}\r\n              </span>\r\n            </span>\r\n          </div>\r\n          {savedMessage && (\r\n            <p className=\"text-[11px] text-emerald-600\">{savedMessage}</p>\r\n          )}\r\n        </div>\r\n      </header>\r\n\r\n      {/* タスク追加 */}\r\n      <section className=\"rounded-xl border bg-white/80 shadow-sm p-4 md:p-5 space-y-3\">\r\n        <h2 className=\"text-base md:text-lg font-semibold\">タスクを追加</h2>\r\n        <div className=\"flex flex-col md:flex-row gap-2.5\">\r\n          <input\r\n            type=\"text\"\r\n            className=\"flex-1 rounded-lg border border-slate-300 px-3 py-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400\"\r\n            placeholder=\"例）画面AのUI調整／バグ#123の原因調査／仕様書レビュー など\"\r\n            value={newTitle}\r\n            onChange={(e) => setNewTitle(e.target.value)}\r\n            onKeyDown={handleKeyDown}\r\n          />\r\n          <button\r\n            type=\"button\"\r\n            onClick={handleAddTask}\r\n            className=\"w-full md:w-auto inline-flex justify-center items-center rounded-lg px-4 py-2.5 text-sm font-medium border border-slate-700 bg-slate-800 text-white hover:bg-slate-700 transition\"\r\n          >\r\n            ＋ 追加\r\n          </button>\r\n        </div>\r\n      </section>\r\n\r\n      {/* タスク一覧 */}\r\n      <section className=\"space-y-3\">\r\n        <div className=\"flex items-center justify-between gap-2\">\r\n          <h2 className=\"text-base md:text-lg font-semibold\">タスク一覧</h2>\r\n        </div>\r\n\r\n        {tasks.length === 0 ? (\r\n          <div className=\"rounded-xl border border-dashed border-slate-300 bg-slate-50/60 p-5 text-center space-y-1.5\">\r\n            <p className=\"text-sm text-slate-600\">まだタスクがありません。</p>\r\n            <p className=\"text-[11px] md:text-xs text-slate-500\">\r\n              上の入力欄から「今週やること」を1行ずつ追加してみてください。\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"rounded-xl border bg-white/90 shadow-sm max-h-[60vh] overflow-y-auto\">\r\n            <ul className=\"divide-y divide-slate-100\">\r\n              {tasks.map((task) => (\r\n                <li\r\n                  key={task.id}\r\n                  className=\"px-3 md:px-4 py-2 md:py-2.5 flex items-start gap-2 md:gap-3\"\r\n                >\r\n                  {/* 左：タスク名（少し大きめ） */}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <p className=\"text-sm md:text-base text-slate-900 break-words\">\r\n                      {task.title}\r\n                    </p>\r\n                  </div>\r\n\r\n                  {/* 右：ステータスボタン群＋削除 */}\r\n                  <div className=\"flex flex-col items-end gap-1 min-w-[150px]\">\r\n                    <div className=\"flex flex-wrap justify-end gap-1\">\r\n                      {STATUS_ORDER.map((status) => {\r\n                        const active = task.status === status;\r\n                        const base =\r\n                          \"px-2 py-[2px] rounded-full text-[11px] border transition focus:outline-none whitespace-nowrap\";\r\n                        const activeStyleByStatus: Record<TaskStatus, string> = {\r\n                          not_decided:\r\n                            \"bg-slate-800 border-slate-800 text-white\",\r\n                          todo: \"bg-amber-500 border-amber-500 text-white\",\r\n                          doing: \"bg-blue-600 border-blue-600 text-white\",\r\n                          done: \"bg-emerald-600 border-emerald-600 text-white\",\r\n                        };\r\n                        const inactiveStyleByStatus: Record<\r\n                          TaskStatus,\r\n                          string\r\n                        > = {\r\n                          not_decided:\r\n                            \"bg-slate-50 border-slate-300 text-slate-700 hover:bg-slate-100\",\r\n                          todo: \"bg-amber-50 border-amber-300 text-amber-700 hover:bg-amber-100\",\r\n                          doing: \"bg-blue-50 border-blue-300 text-blue-700 hover:bg-blue-100\",\r\n                          done: \"bg-emerald-50 border-emerald-300 text-emerald-700 hover:bg-emerald-100\",\r\n                        };\r\n\r\n                        return (\r\n                          <button\r\n                            key={status}\r\n                            type=\"button\"\r\n                            onClick={() =>\r\n                              handleChangeStatus(task.id, status)\r\n                            }\r\n                            className={\r\n                              base +\r\n                              \" \" +\r\n                              (active\r\n                                ? activeStyleByStatus[status]\r\n                                : inactiveStyleByStatus[status])\r\n                            }\r\n                          >\r\n                            {STATUS_LABEL[status]}\r\n                          </button>\r\n                        );\r\n                      })}\r\n                    </div>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => handleDelete(task.id)}\r\n                      className=\"text-[11px] text-red-500 hover:text-red-600 hover:underline\"\r\n                    >\r\n                      削除\r\n                    </button>\r\n                  </div>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        )}\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}