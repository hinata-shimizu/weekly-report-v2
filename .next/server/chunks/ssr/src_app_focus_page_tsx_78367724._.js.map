{"version":3,"sources":["../../../../src/app/focus/page.tsx","../../../../src/components/focus/FocusTimer.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport React, { useEffect, useState, Suspense } from \"react\";\r\nimport { useSearchParams, useRouter } from \"next/navigation\";\r\nimport { loadTasks, saveStoredTags, TASKS_KEY_PREFIX, type Task } from \"@/lib/reportUtils\"; // Assuming we need save logic imports that might not be exported yet, check utils\r\nimport { FocusTimer } from \"@/components/focus/FocusTimer\";\r\nimport { AnimatePresence, motion } from \"framer-motion\";\r\n\r\n// We need a way to save specific report's tasks back to storage from here.\r\n// Since loadTasks is readonly, we'll implement a simple save helper here or assume we can write to localStorage directly using the same key pattern.\r\n\r\nfunction FocusPageContent() {\r\n    const searchParams = useSearchParams();\r\n    const router = useRouter();\r\n\r\n    const reportId = searchParams.get(\"reportId\");\r\n    const taskId = searchParams.get(\"taskId\");\r\n\r\n    const [task, setTask] = useState<Task | null>(null);\r\n    const [loaded, setLoaded] = useState(false);\r\n    const [allTasks, setAllTasks] = useState<Task[]>([]); // Keep all to save back\r\n    const [isCompleted, setIsCompleted] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (!reportId || !taskId) {\r\n            setLoaded(true);\r\n            return;\r\n        }\r\n\r\n        const now = Date.now();\r\n        const tasks = loadTasks(reportId, now);\r\n        setAllTasks(tasks);\r\n\r\n        const found = tasks.find((t) => t.id === taskId);\r\n        if (found) {\r\n            setTask(found);\r\n        }\r\n        setLoaded(true);\r\n    }, [reportId, taskId]);\r\n\r\n    const handleComplete = (elapsedSeconds: number) => {\r\n        setIsCompleted(true);\r\n\r\n        // Save status change\r\n        if (reportId && taskId) {\r\n            const nextTasks = allTasks.map(t => {\r\n                if (t.id === taskId) {\r\n                    return {\r\n                        ...t,\r\n                        status: \"done\" as const,\r\n                        // Only add what was actually spent in this session\r\n                        actualSeconds: (t.actualSeconds || 0) + elapsedSeconds\r\n                    };\r\n                }\r\n                return t;\r\n            });\r\n\r\n            // Persist\r\n            if (typeof window !== \"undefined\") {\r\n                window.localStorage.setItem(`${TASKS_KEY_PREFIX}${reportId}`, JSON.stringify(nextTasks));\r\n            }\r\n        }\r\n\r\n        // Delay route back to show celebration\r\n        setTimeout(() => {\r\n            router.back();\r\n        }, 2000);\r\n    };\r\n\r\n    const handleExit = () => {\r\n        router.back();\r\n    };\r\n\r\n    if (!loaded) return null;\r\n\r\n    if (!task) {\r\n        return (\r\n            <div className=\"min-h-screen bg-slate-950 flex items-center justify-center text-slate-400\">\r\n                <p>„Çø„Çπ„ÇØ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì</p>\r\n                <button onClick={handleExit} className=\"ml-4 underline hover:text-white\">Êàª„Çã</button>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <main className=\"min-h-screen bg-slate-50 flex flex-col items-center justify-center p-4 transition-colors duration-500\">\r\n            <div className=\"w-full max-w-md mx-auto text-center space-y-12\">\r\n                <motion.div\r\n                    initial={{ opacity: 0, y: 10 }}\r\n                    animate={{ opacity: 1, y: 0 }}\r\n                    transition={{ delay: 0.2 }}\r\n                >\r\n                    <h1 className=\"text-xl font-medium text-slate-700 tracking-wide\">\r\n                        {task.title}\r\n                    </h1>\r\n                </motion.div>\r\n\r\n                <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    transition={{ delay: 0.4 }}\r\n                >\r\n                    <FocusTimer\r\n                        initialMinutes={25}\r\n                        onComplete={handleComplete}\r\n                        onExit={handleExit}\r\n                    />\r\n                </motion.div>\r\n            </div>\r\n\r\n            {/* Celebration Overlay */}\r\n            <AnimatePresence>\r\n                {isCompleted && (\r\n                    <motion.div\r\n                        initial={{ opacity: 0 }}\r\n                        animate={{ opacity: 1 }}\r\n                        exit={{ opacity: 0 }}\r\n                        className=\"absolute inset-0 z-50 flex items-center justify-center bg-white/80 backdrop-blur-sm\"\r\n                    >\r\n                        <motion.div\r\n                            initial={{ scale: 0.5, opacity: 0 }}\r\n                            animate={{ scale: 1.2, opacity: 1 }}\r\n                            className=\"text-4xl md:text-6xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 animate-pulse text-center\"\r\n                        >\r\n                            COMPLETED! üéâ\r\n                            <p className=\"text-slate-500 text-lg mt-4 font-medium tracking-widest\">GREAT JOB</p>\r\n                        </motion.div>\r\n                    </motion.div>\r\n                )}\r\n            </AnimatePresence>\r\n        </main>\r\n    );\r\n}\r\n\r\nexport default function FocusPage() {\r\n    return (\r\n        <Suspense fallback={<div className=\"min-h-screen bg-slate-50\" />}>\r\n            <FocusPageContent />\r\n        </Suspense>\r\n    );\r\n}\r\n","\"use client\";\r\n\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { motion } from \"framer-motion\";\r\n\r\ntype Props = {\r\n    initialMinutes: number;\r\n    onComplete: (elapsedSeconds: number) => void;\r\n    onExit: () => void;\r\n};\r\n\r\nexport function FocusTimer({ initialMinutes, onComplete, onExit }: Props) {\r\n    const [timeLeft, setTimeLeft] = useState(initialMinutes * 60);\r\n    const [isRunning, setIsRunning] = useState(false);\r\n    const [duration, setDuration] = useState(initialMinutes * 60);\r\n\r\n    useEffect(() => {\r\n        let interval: NodeJS.Timeout;\r\n        if (isRunning && timeLeft > 0) {\r\n            interval = setInterval(() => {\r\n                setTimeLeft((prev) => prev - 1);\r\n            }, 1000);\r\n        } else if (timeLeft === 0) {\r\n            setIsRunning(false);\r\n            // Don't auto-complete to avoid accidental triggers, let user feel the accomplishment\r\n            // OR maybe play a sound? For now, just stop.\r\n        }\r\n        return () => clearInterval(interval);\r\n    }, [isRunning, timeLeft]);\r\n\r\n    const progress = Math.max(0, timeLeft / duration); // 1.0 -> 0.0\r\n    const minutes = Math.floor(timeLeft / 60);\r\n    const seconds = timeLeft % 60;\r\n    const fmt = (n: number) => String(n).padStart(2, \"0\");\r\n\r\n    const toggleTimer = () => setIsRunning(!isRunning);\r\n    const resetTimer = () => {\r\n        setIsRunning(false);\r\n        setTimeLeft(duration);\r\n    };\r\n\r\n    // Circular Progress Props\r\n    const radius = 120;\r\n    const stroke = 8;\r\n    const normalizedRadius = radius - stroke * 2;\r\n    const circumference = normalizedRadius * 2 * Math.PI;\r\n    const strokeDashoffset = circumference - progress * circumference;\r\n\r\n    return (\r\n        <div className=\"flex flex-col items-center justify-center space-y-8\">\r\n            <div className=\"relative flex items-center justify-center\">\r\n                {/* Background Ring */}\r\n                <svg height={radius * 2} width={radius * 2} className=\"rotate-[-90deg]\">\r\n                    <circle\r\n                        className=\"stroke-slate-200 dark:stroke-[#2f3336]\"\r\n                        strokeWidth={stroke}\r\n                        fill=\"transparent\"\r\n                        r={normalizedRadius}\r\n                        cx={radius}\r\n                        cy={radius}\r\n                    />\r\n                    <motion.circle\r\n                        className=\"stroke-indigo-500 dark:stroke-[#1d9bf0]\"\r\n                        strokeWidth={stroke}\r\n                        fill=\"transparent\"\r\n                        r={normalizedRadius}\r\n                        cx={radius}\r\n                        cy={radius}\r\n                        strokeDasharray={circumference + \" \" + circumference}\r\n                        strokeDashoffset={strokeDashoffset}\r\n                        strokeLinecap=\"round\"\r\n                        initial={{ strokeDashoffset: circumference }}\r\n                        animate={{ strokeDashoffset }}\r\n                        transition={{ duration: 1, ease: \"linear\" }}\r\n                    />\r\n                </svg>\r\n\r\n                {/* Time Display */}\r\n                <div className=\"absolute inset-0 flex flex-col items-center justify-center text-slate-800 dark:text-[#e7e9ea]\">\r\n                    <div className=\"text-6xl font-mono font-bold tracking-widest tabular-nums\">\r\n                        {fmt(minutes)}:{fmt(seconds)}\r\n                    </div>\r\n                    <p className=\"text-sm text-slate-400 dark:text-[#71767b] mt-2 font-medium\">\r\n                        {isRunning ? \"FOCUSING...\" : \"READY\"}\r\n                    </p>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Controls */}\r\n            <div className=\"flex items-center gap-6\">\r\n                <button\r\n                    onClick={onExit}\r\n                    className=\"p-4 rounded-full bg-slate-100 text-slate-400 hover:bg-slate-200 hover:text-slate-600 dark:bg-[#16181c] dark:text-[#71767b] dark:hover:bg-[#2f3336] dark:hover:text-[#e7e9ea] transition-all\"\r\n                    title=\"ÁµÇ‰∫Ü„Åó„Å¶Êàª„Çã\"\r\n                >\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                        <path d=\"M18 6 6 18\" /><path d=\"m6 6 12 12\" />\r\n                    </svg>\r\n                </button>\r\n\r\n                <button\r\n                    onClick={toggleTimer}\r\n                    className=\"p-6 rounded-full bg-white text-indigo-600 shadow-xl border border-indigo-100 dark:bg-black dark:text-[#1d9bf0] dark:border-[#1d9bf0]/50 hover:scale-105 active:scale-95 transition-all\"\r\n                >\r\n                    {isRunning ? (\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                            <path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\" />\r\n                        </svg>\r\n                    ) : (\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"ml-1\">\r\n                            <path d=\"M8 5v14l11-7z\" />\r\n                        </svg>\r\n                    )}\r\n                </button>\r\n\r\n                <button\r\n                    onClick={() => onComplete(duration - timeLeft)}\r\n                    className=\"p-4 rounded-full bg-emerald-50 text-emerald-500 border border-emerald-100 dark:bg-black dark:text-[#00ba7c] dark:border-[#003a27] hover:bg-emerald-500 hover:text-white dark:hover:bg-[#00ba7c] dark:hover:text-white transition-all\"\r\n                    title=\"„Çø„Çπ„ÇØÂÆå‰∫ÜÔºÅ\"\r\n                >\r\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                        <path d=\"M20 6 9 17l-5-5\" />\r\n                    </svg>\r\n                </button>\r\n            </div>\r\n\r\n            <div className=\"text-center\">\r\n                <button\r\n                    onClick={resetTimer}\r\n                    className=\"text-xs text-slate-400 hover:text-slate-600 underline\"\r\n                >\r\n                    „Çø„Ç§„Éû„Éº„Çí„É™„Çª„ÉÉ„Éà\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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"}